const t={name:"windy-plugin-horizon-distance",version:"0.3.0",title:"Clouds Horizon Distance",description:"This plugin displays circles on the Windy map representing the horizon distances for different cloud heights, calculated based on the users clicked position, including the directions of sunrise and sunset. This allows for an approximate estimation of whether sunlight will be blocked by clouds at sunrise or sunset",author:"Francesco Gola",icon:"☀️",desktopUI:"rhpane",mobileUI:"fullscreen",built:1724740369144,builtReadable:"2024-08-27T06:32:49.144Z",screenshot:"screenshot.jpg"},{map:e}=W.map;function n(){}function o(t){return t()}function r(){return Object.create(null)}function a(t){t.forEach(o)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){t.appendChild(e)}function u(t,e,n){const o=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!o.getElementById(e)){const t=d("style");t.id=e,t.textContent=n,function(t,e){l(t.head||t,e),e.sheet}(o,t)}}function c(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function h(){return f(" ")}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function p(t,e){e=""+e,t.data!==e&&(t.data=e)}let g;function w(t){g=t}function x(){if(!g)throw new Error("Function called outside component initialization");return g}const y=[],v=[];let M=[];const b=[],$=Promise.resolve();let C=!1;function _(t){M.push(t)}const k=new Set;let E=0;function F(){if(0!==E)return;const t=g;do{try{for(;E<y.length;){const t=y[E];E++,w(t),P(t.$$)}}catch(t){throw y.length=0,E=0,t}for(w(null),y.length=0,E=0;v.length;)v.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];k.has(e)||(k.add(e),e())}M.length=0}while(y.length);for(;b.length;)b.pop()();C=!1,k.clear(),w(t)}function P(t){if(null!==t.fragment){t.update(),a(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const A=new Set;function I(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];M.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),M=e}(n.after_update),a(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function T(t,e){-1===t.$$.dirty[0]&&(y.push(t),C||(C=!0,$.then(F)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(t,e,i,l,u,d,f=null,h=[-1]){const m=g;w(t);const p=t.$$={fragment:null,ctx:[],props:d,update:n,not_equal:u,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(m?m.$$.context:[])),callbacks:r(),dirty:h,skip_bound:!1,root:e.target||m.$$.root};f&&f(p.root);let x=!1;if(p.ctx=i?i(t,e.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&u(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),x&&T(t,e)),n})):[],p.update(),x=!0,a(p.before_update),p.fragment=!!l&&l(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(c)}else p.fragment&&p.fragment.c();e.intro&&((y=t.$$.fragment)&&y.i&&(A.delete(y),y.i(v))),function(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),_((()=>{const e=t.$$.on_mount.map(o).filter(s);t.$$.on_destroy?t.$$.on_destroy.push(...e):a(e),t.$$.on_mount=[]})),i.forEach(_)}(t,e.target,e.anchor),F()}var y,v;w(m)}class O{$$=void 0;$$set=void 0;$destroy(){I(this,1),this.$destroy=n}$on(t,e){if(!s(e))return n;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(e),()=>{const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function z(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");var H,N={exports:{}};H=N,function(){var t=Math.PI,e=Math.sin,n=Math.cos,o=Math.tan,r=Math.asin,a=Math.atan2,s=Math.acos,i=t/180,l=864e5,u=2440588,c=2451545;function d(t){return new Date((t+.5-u)*l)}function f(t){return function(t){return t.valueOf()/l-.5+u}(t)-c}var h=23.4397*i;function m(t,r){return a(e(t)*n(h)-o(r)*e(h),n(t))}function p(t,o){return r(e(o)*n(h)+n(o)*e(h)*e(t))}function g(t,r,s){return a(e(t),n(t)*e(r)-o(s)*n(r))}function w(t,o,a){return r(e(o)*e(a)+n(o)*n(a)*n(t))}function x(t,e){return i*(280.16+360.9856235*t)-e}function y(t){return i*(357.5291+.98560028*t)}function v(n){return n+i*(1.9148*e(n)+.02*e(2*n)+3e-4*e(3*n))+102.9372*i+t}function M(t){var e=v(y(t));return{dec:p(e,0),ra:m(e,0)}}var b={getPosition:function(t,e,n){var o=i*-n,r=i*e,a=f(t),s=M(a),l=x(a,o)-s.ra;return{azimuth:g(l,r,s.dec),altitude:w(l,r,s.dec)}}},$=b.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];b.addTime=function(t,e,n){$.push([t,e,n])};var C=9e-4;function _(e,n,o){return C+(e+n)/(2*t)+o}function k(t,n,o){return c+t+.0053*e(n)-.0069*e(2*o)}function L(t,o,r,a,i,l,u){var c=function(t,o,r){return s((e(t)-e(o)*e(r))/(n(o)*n(r)))}(t,r,a);return k(_(c,o,i),l,u)}function E(t){var o=i*(134.963+13.064993*t),r=i*(93.272+13.22935*t),a=i*(218.316+13.176396*t)+6.289*i*e(o),s=5.128*i*e(r),l=385001-20905*n(o);return{ra:m(a,s),dec:p(a,s),dist:l}}function F(t,e){return new Date(t.valueOf()+e*l/24)}b.getTimes=function(e,n,o,r){var a,s,l,u,c,h=i*-o,m=i*n,g=function(t){return-2.076*Math.sqrt(t)/60}(r=r||0),w=function(e,n){return Math.round(e-C-n/(2*t))}(f(e),h),x=_(0,h,w),M=y(x),b=v(M),E=p(b,0),F=k(x,M,b),P={solarNoon:d(F),nadir:d(F-.5)};for(a=0,s=$.length;a<s;a+=1)c=F-((u=L(((l=$[a])[0]+g)*i,h,m,E,w,M,b))-F),P[l[1]]=d(c),P[l[2]]=d(u);return P},b.getMoonPosition=function(t,r,s){var l=i*-s,u=i*r,c=f(t),d=E(c),h=x(c,l)-d.ra,m=w(h,u,d.dec),p=a(e(h),o(u)*n(d.dec)-e(d.dec)*n(h));return m+=function(t){return t<0&&(t=0),2967e-7/Math.tan(t+.00312536/(t+.08901179))}(m),{azimuth:g(h,u,d.dec),altitude:m,distance:d.dist,parallacticAngle:p}},b.getMoonIllumination=function(t){var o=f(t||new Date),r=M(o),i=E(o),l=149598e3,u=s(e(r.dec)*e(i.dec)+n(r.dec)*n(i.dec)*n(r.ra-i.ra)),c=a(l*e(u),i.dist-l*n(u)),d=a(n(r.dec)*e(r.ra-i.ra),e(r.dec)*n(i.dec)-n(r.dec)*e(i.dec)*n(r.ra-i.ra));return{fraction:(1+n(c))/2,phase:.5+.5*c*(d<0?-1:1)/Math.PI,angle:d}},b.getMoonTimes=function(t,e,n,o){var r=new Date(t);o?r.setUTCHours(0,0,0,0):r.setHours(0,0,0,0);for(var a,s,l,u,c,d,f,h,m,p,g,w,x,y=.133*i,v=b.getMoonPosition(r,e,n).altitude-y,M=1;M<=24&&(a=b.getMoonPosition(F(r,M),e,n).altitude-y,h=((c=(v+(s=b.getMoonPosition(F(r,M+1),e,n).altitude-y))/2-a)*(f=-(d=(s-v)/2)/(2*c))+d)*f+a,p=0,(m=d*d-4*c*a)>=0&&(g=f-(x=Math.sqrt(m)/(2*Math.abs(c))),w=f+x,Math.abs(g)<=1&&p++,Math.abs(w)<=1&&p++,g<-1&&(g=w)),1===p?v<0?l=M+g:u=M+g:2===p&&(l=M+(h<0?w:g),u=M+(h<0?g:w)),!l||!u);M+=2)v=s;var $={};return l&&($.rise=F(r,l)),u&&($.set=F(r,u)),l||u||($[h>0?"alwaysUp":"alwaysDown"]=!0),$},H.exports=b}();var j=z(N.exports);function S(t){u(t,"svelte-r7w4yx",".info-box.svelte-r7w4yx{position:fixed;bottom:60px;left:20px;background-color:var(--color-transparent);color:white;padding:10px;border-radius:5px;box-shadow:0 2px 10px rgba(0, 0, 0, 0.1);max-width:250px;font-family:Arial, sans-serif}fieldset.svelte-r7w4yx{border:none;margin-bottom:10px}legend.svelte-r7w4yx{font-weight:bold;margin-bottom:5px;color:white}label.svelte-r7w4yx{display:block;margin-bottom:5px;color:white}")}function q(t){let e,o,r,a,s,i,u,g,w,x,y,v,M,b,$,C,_,k,L,E,F,P,A,I,T,D,O,z,H,N,j,S,q,U,R,B,W,G,Z,J,K,Q,V,X,Y,tt,et,nt=t[3].lowCloudsMin.toFixed(2)+"",ot=t[3].lowCloudsMax.toFixed(2)+"",rt=t[3].middleCloudsMin.toFixed(2)+"",at=t[3].middleCloudsMax.toFixed(2)+"",st=t[3].highClouds.toFixed(2)+"";return{c(){e=d("div"),o=d("fieldset"),r=d("legend"),r.textContent="Coordinates",a=h(),s=d("label"),i=f("Latitude: "),u=f(t[0]),g=h(),w=d("label"),x=f("Longitude: "),y=f(t[1]),v=h(),M=d("fieldset"),b=d("legend"),b.textContent="Altitude",$=h(),C=d("label"),_=f("Elevation: "),k=f(t[2]),L=f(" m"),E=h(),F=d("fieldset"),P=d("legend"),P.textContent="Horizon Distance (Clouds)",A=h(),I=d("label"),T=f("Low Clouds 300m: "),D=f(nt),O=f(" km"),z=h(),H=d("label"),N=f("Low Clouds 600m: "),j=f(ot),S=f(" km"),q=h(),U=d("label"),R=f("Middle Clouds 1500m: "),B=f(rt),W=f(" km"),G=h(),Z=d("label"),J=f("Middle Clouds 2500m: "),K=f(at),Q=f(" km"),V=h(),X=d("label"),Y=f("High Clouds 6500m: "),tt=f(st),et=f(" km"),m(r,"class","svelte-r7w4yx"),m(s,"class","svelte-r7w4yx"),m(w,"class","svelte-r7w4yx"),m(o,"class","svelte-r7w4yx"),m(b,"class","svelte-r7w4yx"),m(C,"class","svelte-r7w4yx"),m(M,"class","svelte-r7w4yx"),m(P,"class","svelte-r7w4yx"),m(I,"class","svelte-r7w4yx"),m(H,"class","svelte-r7w4yx"),m(U,"class","svelte-r7w4yx"),m(Z,"class","svelte-r7w4yx"),m(X,"class","svelte-r7w4yx"),m(F,"class","svelte-r7w4yx"),m(e,"class","info-box svelte-r7w4yx")},m(t,n){!function(t,e,n){t.insertBefore(e,n||null)}(t,e,n),l(e,o),l(o,r),l(o,a),l(o,s),l(s,i),l(s,u),l(o,g),l(o,w),l(w,x),l(w,y),l(e,v),l(e,M),l(M,b),l(M,$),l(M,C),l(C,_),l(C,k),l(C,L),l(e,E),l(e,F),l(F,P),l(F,A),l(F,I),l(I,T),l(I,D),l(I,O),l(F,z),l(F,H),l(H,N),l(H,j),l(H,S),l(F,q),l(F,U),l(U,R),l(U,B),l(U,W),l(F,G),l(F,Z),l(Z,J),l(Z,K),l(Z,Q),l(F,V),l(F,X),l(X,Y),l(X,tt),l(X,et)},p(t,[e]){1&e&&p(u,t[0]),2&e&&p(y,t[1]),4&e&&p(k,t[2]),8&e&&nt!==(nt=t[3].lowCloudsMin.toFixed(2)+"")&&p(D,nt),8&e&&ot!==(ot=t[3].lowCloudsMax.toFixed(2)+"")&&p(j,ot),8&e&&rt!==(rt=t[3].middleCloudsMin.toFixed(2)+"")&&p(B,rt),8&e&&at!==(at=t[3].middleCloudsMax.toFixed(2)+"")&&p(K,at),8&e&&st!==(st=t[3].highClouds.toFixed(2)+"")&&p(tt,st)},i:n,o:n,d(t){t&&c(e)}}}const U=1.7;function R(t,e){const n=t+U+e;return Math.sqrt(12742*n/1e3)}function B(t,e,n,o){const r=6371,a=n*Math.PI/180,s=t*Math.PI/180,i=e*Math.PI/180,l=Math.asin(Math.sin(s)*Math.cos(o/r)+Math.cos(s)*Math.sin(o/r)*Math.cos(a)),u=i+Math.atan2(Math.sin(a)*Math.sin(o/r)*Math.cos(s),Math.cos(o/r)-Math.sin(s)*Math.sin(l));return[180*l/Math.PI,180*u/Math.PI]}function G(t,n,o){let r=0,a=0,s=0,i={lowCloudsMin:0,lowCloudsMax:0,middleCloudsMin:0,middleCloudsMax:0,highClouds:0},l=[],u=[],c=null,d=null;function f(t,e,n){return 180*j.getPosition(n,t,e).azimuth/Math.PI+180}async function h(t){const{lat:n,lng:h}=t.latlng;o(0,r=parseFloat(n.toFixed(2))),o(1,a=parseFloat(h.toFixed(2)));try{o(2,s=await async function(t,e){const n=`https://api.open-elevation.com/api/v1/lookup?locations=${t},${e}`,o=await fetch(n),r=await o.json();if(r.results&&r.results.length)return r.results[0].elevation;throw new Error("Elevation data not found")}(r,a)),o(3,i={lowCloudsMin:R(s,300),lowCloudsMax:R(s,600),middleCloudsMin:R(s,1500),middleCloudsMax:R(s,2500),highClouds:R(s,6500)}),function(t,n,o,r){l.forEach((t=>e.removeLayer(t))),l=[],u.forEach((t=>e.removeLayer(t))),u=[];const a=[{color:"blue",dashArray:"5, 5",weight:2},{color:"blue",dashArray:"5, 5",weight:2},{color:"green",dashArray:"5, 5",weight:2},{color:"green",dashArray:"5, 5",weight:2},{color:"red",dashArray:"5, 5",weight:2}];o.forEach(((o,s)=>{const i=L.circle([t,n],{color:a[s].color,dashArray:a[s].dashArray,weight:a[s].weight,fillOpacity:0,radius:1e3*o}).addTo(e);l.push(i);const c=L.latLng(t+o/111,n),d=L.marker(c,{icon:L.divIcon({className:"label",html:`<div style="color: ${a[s].color}; font-weight: bold;">${r[s]} (${Math.round(o)}km)</div>`,iconSize:[200,40]})}).addTo(e);u.push(d)}))}(r,a,Object.values(i),["Low Clouds 300m","Low Clouds 600m","Mid Clouds 1500m","Mid Clouds 2500m","High Clouds 6500m"]),function(t,n,o,r){const a=r+10,s=f(t,n,o.sunrise),i=f(t,n,o.sunset),l=B(t,n,s,a),u=B(t,n,i,a);c&&e.removeLayer(c),d&&e.removeLayer(d),c=L.polyline([[t,n],l],{color:"yellow"}).addTo(e),d=L.polyline([[t,n],u],{color:"orange"}).addTo(e)}(r,a,j.getTimes(new Date,r,a),i.highClouds)}catch(t){console.error(`Failed to process click: ${t.message}`)}}var m;return m=()=>{e&&e.on&&e.on("click",h)},x().$$.on_mount.push(m),function(t){x().$$.on_destroy.push(t)}((()=>{e&&e.off&&e.off("click",h),l.forEach((t=>e.removeLayer(t))),u.forEach((t=>e.removeLayer(t))),c&&e.removeLayer(c),d&&e.removeLayer(d)})),[r,a,s,i]}class Z extends O{constructor(t){super(),D(this,t,G,q,i,{},S)}}export{t as __pluginConfig,Z as default};
